<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shipping Agent Redirector</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="extension-popup">
        <div class="header">
            <h1>Agent Redirector</h1>
            <p>Streamline your shopping experience</p>
        </div>
        
        <div class="content">
            <!-- Auto-Convert Toggle -->
            <div class="toggle-section">
                <span class="toggle-label">Auto-Convert Links</span>
                <div class="toggle" id="auto-convert-toggle">
                    <div class="toggle-slider"></div>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="redirect-count">0</div>
                    <div class="stat-label">Redirects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="favorites-count">0</div>
                    <div class="stat-label">Saved</div>
                </div>
            </div>
            
            <!-- Current Page Info -->
            <div class="current-page" id="current-page-info" style="display: none;">
                <div class="page-info">
                    <div class="page-platform">Platform: <span id="current-platform">-</span></div>
                    <div class="page-item">Item: <span id="current-item">-</span></div>
                </div>
                <div class="page-actions">
                    <button class="btn btn-sm btn-primary" id="convert-current">Convert</button>
                    <button class="btn btn-sm btn-secondary" id="save-current">Save</button>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="batch-convert-btn">Batch Convert</button>
                <button class="btn btn-secondary" id="view-history-btn">View History</button>
            </div>
            
            <!-- Quick Links -->
            <div class="quick-links">
                <a href="#" class="quick-link" id="manage-favorites">
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                    Manage Favorites
                </a>
                <a href="#" class="quick-link" id="view-settings">
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                    </svg>
                    Settings
                </a>
            </div>
        </div>

        <!-- Hidden panels for different views -->
        <div class="panel" id="batch-convert-panel" style="display: none;">
            <div class="panel-header">
                <button class="btn-back" id="batch-back">&larr;</button>
                <h2>Batch Convert</h2>
            </div>
            <div class="panel-content">
                <textarea 
                    id="batch-urls" 
                    placeholder="Paste URLs here, one per line..."
                    rows="6"
                ></textarea>
                <div class="batch-actions">
                    <button class="btn btn-primary" id="convert-batch">Convert All</button>
                    <button class="btn btn-secondary" id="clear-batch">Clear</button>
                </div>
                <div class="batch-results" id="batch-results" style="display: none;">
                    <h3>Results:</h3>
                    <div class="results-list" id="results-list"></div>
                    <button class="btn btn-secondary btn-sm" id="copy-results">Copy All</button>
                </div>
            </div>
        </div>

        <div class="panel" id="history-panel" style="display: none;">
            <div class="panel-header">
                <button class="btn-back" id="history-back">&larr;</button>
                <h2>History</h2>
            </div>
            <div class="panel-content">
                <div class="history-actions">
                    <button class="btn btn-secondary btn-sm" id="clear-history">Clear All</button>
                </div>
                <div class="history-list" id="history-list">
                    <!-- History items will be populated here -->
                </div>
            </div>
        </div>

        <div class="panel" id="favorites-panel" style="display: none;">
            <div class="panel-header">
                <button class="btn-back" id="favorites-back">&larr;</button>
                <h2>Favorites</h2>
            </div>
            <div class="panel-content">
                <div class="search-box">
                    <input type="text" id="favorites-search" placeholder="Search favorites...">
                </div>
                <div class="favorites-list" id="favorites-list">
                    <!-- Favorites will be populated here -->
                </div>
            </div>
        </div>

        <div class="panel" id="settings-panel" style="display: none;">
            <div class="panel-header">
                <button class="btn-back" id="settings-back">&larr;</button>
                <h2>Quick Settings</h2>
                <button class="btn-gear" id="full-settings">⚙️</button>
            </div>
            <div class="panel-content">
                <!-- Preferred Agent Setting -->
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-title">Preferred Agent</span>
                        <span class="setting-description">Default shipping agent to redirect to</span>
                    </label>
                    <select id="popup-preferred-agent" class="setting-select">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>

                <!-- Currency Setting -->
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-title">Target Currency</span>
                        <span class="setting-description">Currency to convert CNY prices to</span>
                    </label>
                    <select id="popup-currency-select" class="setting-select">
                        <option value="USD">USD - US Dollar</option>
                        <option value="EUR">EUR - Euro</option>
                        <option value="GBP">GBP - British Pound</option>
                        <option value="CAD">CAD - Canadian Dollar</option>
                        <option value="AUD">AUD - Australian Dollar</option>
                        <option value="JPY">JPY - Japanese Yen</option>
                        <option value="CNY">CNY - Chinese Yuan</option>
                    </select>
                </div>

                <!-- Currency Conversion Toggle -->
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-title">Currency Conversion</span>
                        <span class="setting-description">Show converted prices on product pages</span>
                    </label>
                    <div class="toggle" id="popup-currency-toggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>

                <!-- Theme Setting -->
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-title">Theme</span>
                        <span class="setting-description">Choose your preferred color scheme</span>
                    </label>
                    <select id="popup-theme-select" class="setting-select">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="auto">Auto (System)</option>
                    </select>
                </div>

                <!-- Quick Actions -->
                <div class="setting-actions">
                    <button class="btn btn-secondary" id="export-data-popup">Export Data</button>
                    <button class="btn btn-secondary" id="clear-data-popup">Clear All Data</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../lib/converter.js"></script>
    <script src="../lib/storage.js"></script>
    <script src="popup.js"></script>
</body>
</html>